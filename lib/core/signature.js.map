{"version":3,"sources":["../../src/core/signature.js"],"names":["UdeskJSApi","sha1","queryWithParams","getSignature","id","now","Date","getTime","nonce","timestamp","web_token","im_user_key","signs","sign_str","signature","toUpperCase","console","log"],"mappings":";AACA,OAAOA,UAAP,MAAuB,0BAAvB;AACA,SAAQC,IAAR,QAAmB,0BAAnB;AACA,OAAOC,eAAP,MAA4B,4BAA5B;;AAEA,eAAe,SAASC,YAAT,CAAsBC,EAAtB,EAA0B;AACvC,MAAIC,MAAM,IAAIC,IAAJ,GAAWC,OAAX,EAAV;;AAEA,MAAIC,QAASH,MAAM,CAAP,GAAY,EAAxB;AACA,MAAII,YAAYJ,MAAM,EAAtB;AACA,MAAIK,YAAYN,MAAM,EAAtB;AACA,MAAIO,cAAcX,WAAWW,WAA7B;AACA;AACA;AACA;;AAEA,MAAIC,QAAQ,EAACJ,KAAD,EAAQC,SAAR,EAAmBC,SAAnB,EAAZ;;AAEA,MAAIG,WAAWX,gBAAgBU,KAAhB,CAAf;AACAC,cAAY,MAAMF,WAAlB;;AAEA,MAAIG,YAAYb,KAAKY,QAAL,CAAhB;AACA,MAAIC,aAAa,OAAOA,SAAP,IAAoB,QAArC,EAA+C;AAC7CA,gBAAYA,UAAUC,WAAV,EAAZ;AACD,GAFD,MAGK;AACHD,gBAAY,EAAZ;AACAE,YAAQC,GAAR,CAAY,qCAAZ;AACD;AACD;AACA;AACA;AACA,SAAO,EAACT,KAAD,EAAQC,SAAR,EAAmBC,SAAnB,EAA8BI,SAA9B,EAAyCH,WAAzC,EAAP;AACD","file":"signature.js","sourcesContent":["\r\nimport UdeskJSApi from '../services/udesk-js-api'\r\nimport {sha1} from '../utils/encryption/sha1'\r\nimport queryWithParams from '../utils/query-with-params'\r\n\r\nexport default function getSignature(id) {\r\n  let now = new Date().getTime();\r\n\r\n  let nonce = (now * 2) + '';\r\n  let timestamp = now + '';\r\n  let web_token = id || '';\r\n  let im_user_key = UdeskJSApi.im_user_key;\r\n  // if (process.env.NODE_ENV === 'development') {\r\n  //   console.log('im_user_key=>', im_user_key);\r\n  // }\r\n\r\n  let signs = {nonce, timestamp, web_token}\r\n\r\n  let sign_str = queryWithParams(signs)\r\n  sign_str += '&' + im_user_key;\r\n  \r\n  let signature = sha1(sign_str);\r\n  if (signature && typeof signature == 'string') {\r\n    signature = signature.toUpperCase();\r\n  }\r\n  else {\r\n    signature = ''\r\n    console.log('ud_signature -> signature fail fail')\r\n  }\r\n  // if (process.env.NODE_ENV === 'development') {\r\n  //   console.log('ud_signatureMinin() =>', nonce, timestamp, web_token, signature)\r\n  // }\r\n  return {nonce, timestamp, web_token, signature, im_user_key};\r\n}"]}